
<br>

<h2>Nodes API</h2>

<table class="table">
<tr><td><b>GET /nodes</b></td><td></td></tr>

<tr>
    <td>
        <a href="../nodes">/nodes</a>
    </td>
    <td>

<pre>
{
    "10":{
        "nodename":"House",
        "firmware":"emontx_firmware_continuous",
        "hardware":"EmonTx v3.4",
        "time":1423344776,
        "rx": {
            "names":["power1","power2","power3"],
            "values":["100","200","300"],
            "units":["W","W","W"]
        },
        "tx": {
            "names":["setpoint","status"],
            "values":["18.0","1"],
            "units":["C",""]
        }
    }
}</pre>

    </td>
</tr>

<tr><td><b>GET /nodes/nodeid</b></td><td></td></tr>

<tr>
    <td>
        <a href="../nodes/10">/nodes/10</a>
    </td>
    <td>
    
<pre>
{
    "nodename":"House",
    "firmware":"emontx_firmware_continuous",
    "hardware":"EmonTx v3.4",
    "time":1423344776,
    "names":["power1","power2","power3"],
    "values":["100","200","300"],
    "units":["W","W","W"]
}</pre>

    </td>
</tr>

<tr>
    <td><a href="../nodes/10/nodename">/nodes/10/nodename</a></td>
    <td><pre>"House"</pre></td>
</tr>
<tr>
    <td><a href="../nodes/10/hardware">/nodes/10/hardware</a></td>
    <td><pre>"EmonTx v3.4"</pre></td>
</tr>
<tr>
    <td><a href="../nodes/10/firmware">/nodes/10/firmware</a></td>
    <td><pre>"emontx_firmware_continuous"</pre></td>
</tr>
<tr>
    <td><a href="../nodes/10/rx/names">/nodes/10/rx/names</a></td>
    <td><pre>["power1","power2","power3"]</pre></td>
</tr>
<tr>
    <td><a href="../nodes/10/rx/values">/nodes/10/rx/values</a></td>
    <td><pre>[100,200,300]</pre></td>
</tr>
<tr>
    <td><a href="../nodes/10/rx/units">/nodes/10/rx/units</a></td>
    <td><pre>["W","W","W"]</pre></td>
</tr>

<tr><td><b>GET nodes/nodeid/varid</b></td><td></td></tr>
<tr>
    <td><a href="../nodes/10/rx/0">/nodes/10/rx/0</a></td>
    <td><pre>{"name":"power1","value":"100","unit":"W"}</pre></td>
</tr>
<tr>
    <td><a href="../nodes/10/rx/0/name">/nodes/10/rx/0/name</a></td>
    <td><pre>"power1"</pre></td>
</tr>
<tr>
    <td><a href="../nodes/10/rx/0/value">/nodes/10/rx/0/value</a></td>
    <td><pre>100</pre></td>
</tr>
<tr>
    <td><a href="../nodes/10/rx/0/unit">/nodes/10/rx/0/unit</a></td>
    <td><pre>"W"</pre></td>
</tr>

<tr><td><b>POST nodes</b></td><td></td></tr>

<tr><td><b>POST /nodes/nodeid</b></td><td></td></tr>

<tr contentType="text/plain">
    <td><input class="apiurl" type="text" value="/nodes/10/nodename"></td>
    <td>
        <div class="input-append">
            <input class="apivalue" type="text" value="House">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr contentType="text/plain">
    <td><input class="apiurl" type="text" value="/nodes/10/hardware"></td>
    <td>
        <div class="input-append">
            <input class="apivalue" type="text" value="EmonTx v3.4">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr contentType="text/plain">
    <td><input class="apiurl" type="text" value="/nodes/10/firmware"></td>
    <td>
        <div class="input-append">
            <input class="apivalue" type="text" value="emontx_firmware_continuous">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr contentType="text/plain">
    <td><input class="apiurl" type="text" value="/nodes/10/rx/values"></td>
    <td>
        <div class="input-append">
            <input class="apivalue" type="text" value="100,200,300">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr contentType="text/plain">
    <td><input class="apiurl" type="text" value="/nodes/10/rx/names"></td>
    <td>
        <div class="input-append">
            <input class="apivalue" type="text" value="power1,power2,power3">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr contentType="text/plain">
    <td><input class="apiurl" type="text" value="/nodes/10/rx/units"></td>
    <td>
        <div class="input-append">
            <input class="apivalue" type="text" value="W,W,W">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr><td><b>POST nodes/nodeid/rxtx/varid</b></td><td></td></tr>
<tr contentType="text/plain">
    <td><input class="apiurl" type="text" value="/nodes/10/rx/0/name"></td>
    <td>
        <div class="input-append">
            <input class="apivalue" type="text" value="power1">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
<tr contentType="text/plain">
    <td><input class="apiurl" type="text" value="/nodes/10/rx/0/unit"></td>
    <td>
        <div class="input-append">
            <input class="apivalue" type="text" value="W">
            <button class="btn ok">ok</button>
        </div>
    </td>
</tr>
</table>

<script>
var path = window.location.href.replace("/nodes/apidocs","");
console.log(path);

$(".ok").click(function(){
    var tr = $(this).parent().parent().parent();
    var contentType = tr.attr("contentType");
    var apiurl = tr.find("input[class='apiurl']").val();
    var apivalue = tr.find("input[class='apivalue']").val();
    
    if (apivalue==undefined) {
        apivalue = tr.find("textarea").val();
    }
    
    $.ajax({ 
        type: "POST",
        contentType: contentType,
        url: path + apiurl,
        data: apivalue
    });
});
</script>

